# SQL 文件整理总结

## 🚀 终极部署方案 (推荐)

1. **`PROJECT_FLOW_COMPLETE_V2.sql`** ⭐⭐⭐⭐⭐
   - **用途**：**一键全功能部署脚本 (v2.2.0)**
   - **内容**：整合了所有表结构、最新 RLS 架构修复（解决递归与权限隔离）、高性能索引以及完善的团队邀请功能。
   - **优势**：
     - **一键式**：无需分步执行多个 SQL 文件。
     - **无死锁**：使用安全定义函数彻底解决了 RLS 递归。
     - **高性能**：包含针对提醒引擎和工作台优化的复合索引。
   - **执行方式**：在 Supabase SQL Editor 中直接全选执行。

---

## 📂 历史与分步安装文件 (高级/备选)

这些文件已整合进 V2 版本，仅在需要进行局部修复或深入了解架构时参考。

### 核心分步文件
- **`TEAM_DATABASE_COMPLETE.sql`**：基础架构脚本。
- **`TEAM_INVITATIONS_SETUP.sql`**：独立的邀请功能脚本。
- **`OPTIMIZED_TEAM_RLS.sql`**：专门的 RLS 权限优化脚本。
- **`PERFORMANCE_INDEXES.sql`**：专门的性能索引增强脚本。

### 故障修复
- **`FIX_TEAM_INVITATION_FUNCTION_SIMPLE.sql`**：专门用于修复旧版邀请函数的栈溢出问题。
- **`FIX_RLS_RECURSION.sql`**：旧版 RLS 递归修复方案。

### 数据迁移
- **`MIGRATION_EXECUTE.sql`**：从个人日程版 (v1.0) 迁移数据的辅助脚本。

---

## 📊 部署统计
- **核心表数量**：9 个
- **安全函数**：4 个关键逻辑封装
- **推荐索引**：12 个核心索引
- **兼容性**：Supabase PostgreSQL 最新版

---
**最后更新**：2026-01-28
